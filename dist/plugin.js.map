{"version":3,"file":"plugin.js","sources":["esm/index.js","esm/web.js"],"sourcesContent":["import { registerPlugin } from '@capacitor/core';\r\nconst Auth0Capacitor = registerPlugin('Auth0Capacitor', {\r\n    web: () => import('./web').then(m => new m.Auth0CapacitorWeb()),\r\n});\r\nexport * from './definitions';\r\nexport { Auth0Capacitor };\r\n//# sourceMappingURL=index.js.map","import { WebPlugin } from '@capacitor/core';\r\nimport { createAuth0Client } from '@auth0/auth0-spa-js';\r\nexport class Auth0CapacitorWeb extends WebPlugin {\r\n    get auth0() {\r\n        return this._auth0;\r\n    }\r\n    set auth0(client) {\r\n        this._auth0 = client;\r\n    }\r\n    async createAuth0Client(options) {\r\n        this.auth0 = createAuth0Client({\r\n            domain: options.domain,\r\n            clientId: options.clientId,\r\n            authorizationParams: options.authorizationParams\r\n        });\r\n        this.domain = options.domain;\r\n        this.client_id = options.clientId;\r\n    }\r\n    async login(options) {\r\n        var _a;\r\n        console.log(\"Logging in! 1\");\r\n        (_a = (await this.auth0)) === null || _a === void 0 ? void 0 : _a.loginWithRedirect(Object.assign({}, options));\r\n    }\r\n    async handleRedirect() {\r\n        var _a;\r\n        const query = window.location.search;\r\n        if (!query.length)\r\n            return;\r\n        if (query.includes(\"code=\") && query.includes(\"state=\")) {\r\n            // Process the login state\r\n            const resultP = (_a = (await this.auth0)) === null || _a === void 0 ? void 0 : _a.handleRedirectCallback().then(async (result) => {\r\n                var _a;\r\n                console.log(result);\r\n                return (_a = (await this.auth0)) === null || _a === void 0 ? void 0 : _a.getTokenSilently();\r\n            });\r\n            return await resultP;\r\n        }\r\n    }\r\n    async renew() {\r\n        const client = await this.auth0;\r\n        const isAuth = client === null || client === void 0 ? void 0 : client.isAuthenticated();\r\n        if (isAuth) {\r\n            return client === null || client === void 0 ? void 0 : client.getTokenSilently({ detailedResponse: true });\r\n        }\r\n        else {\r\n            const query = window.location.search;\r\n            if (query.includes(\"code=\") && query.includes(\"state=\")) {\r\n                // Process the login state\r\n                return client === null || client === void 0 ? void 0 : client.handleRedirectCallback(location.href).then((result) => {\r\n                    console.log(result);\r\n                    return client === null || client === void 0 ? void 0 : client.getTokenSilently({ detailedResponse: true });\r\n                });\r\n            }\r\n            else {\r\n                throw 'not authenticated';\r\n            }\r\n        }\r\n    }\r\n    async logout() {\r\n        var _a;\r\n        (_a = (await this.auth0)) === null || _a === void 0 ? void 0 : _a.logout({\r\n            logoutParams: {\r\n                returnTo: window.location.origin\r\n            }\r\n        });\r\n    }\r\n    async getUser() {\r\n        var _a;\r\n        return (_a = (await this.auth0)) === null || _a === void 0 ? void 0 : _a.getUser();\r\n    }\r\n    async getTokenSilently() {\r\n        return this.renew();\r\n    }\r\n}\r\n//# sourceMappingURL=web.js.map"],"names":["registerPlugin","WebPlugin","createAuth0Client"],"mappings":"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"}