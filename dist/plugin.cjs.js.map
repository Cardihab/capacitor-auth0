{"version":3,"file":"plugin.cjs.js","sources":["esm/index.js","esm/web.js"],"sourcesContent":["import { registerPlugin } from '@capacitor/core';\r\nconst Auth0Capacitor = registerPlugin('Auth0Capacitor', {\r\n    web: () => import('./web').then(m => new m.Auth0CapacitorWeb()),\r\n});\r\nexport * from './definitions';\r\nexport { Auth0Capacitor };\r\n//# sourceMappingURL=index.js.map","import { WebPlugin } from '@capacitor/core';\r\nimport { createAuth0Client } from '@auth0/auth0-spa-js';\r\nexport class Auth0CapacitorWeb extends WebPlugin {\r\n    get auth0() {\r\n        return this._auth0;\r\n    }\r\n    set auth0(client) {\r\n        this._auth0 = client;\r\n    }\r\n    async createAuth0Client(options) {\r\n        this.auth0 = createAuth0Client({\r\n            domain: options.domain,\r\n            clientId: options.clientId,\r\n            authorizationParams: options.authorizationParams\r\n        });\r\n        this.domain = options.domain;\r\n        this.client_id = options.clientId;\r\n    }\r\n    async login(options) {\r\n        var _a;\r\n        console.log(\"Logging in! 1\");\r\n        (_a = (await this.auth0)) === null || _a === void 0 ? void 0 : _a.loginWithRedirect(Object.assign({}, options));\r\n    }\r\n    async handleRedirect() {\r\n        var _a;\r\n        const query = window.location.search;\r\n        if (!query.length)\r\n            return;\r\n        if (query.includes(\"code=\") && query.includes(\"state=\")) {\r\n            // Process the login state\r\n            const resultP = (_a = (await this.auth0)) === null || _a === void 0 ? void 0 : _a.handleRedirectCallback().then(async (result) => {\r\n                var _a;\r\n                console.log(result);\r\n                return (_a = (await this.auth0)) === null || _a === void 0 ? void 0 : _a.getTokenSilently();\r\n            });\r\n            return await resultP;\r\n        }\r\n    }\r\n    async renew() {\r\n        const client = await this.auth0;\r\n        const isAuth = client === null || client === void 0 ? void 0 : client.isAuthenticated();\r\n        if (isAuth) {\r\n            return client === null || client === void 0 ? void 0 : client.getTokenSilently({ detailedResponse: true });\r\n        }\r\n        else {\r\n            const query = window.location.search;\r\n            if (query.includes(\"code=\") && query.includes(\"state=\")) {\r\n                // Process the login state\r\n                return client === null || client === void 0 ? void 0 : client.handleRedirectCallback(location.href).then((result) => {\r\n                    console.log(result);\r\n                    return client === null || client === void 0 ? void 0 : client.getTokenSilently({ detailedResponse: true });\r\n                });\r\n            }\r\n            else {\r\n                throw 'not authenticated';\r\n            }\r\n        }\r\n    }\r\n    async logout() {\r\n        var _a;\r\n        (_a = (await this.auth0)) === null || _a === void 0 ? void 0 : _a.logout({\r\n            logoutParams: {\r\n                returnTo: window.location.origin\r\n            }\r\n        });\r\n    }\r\n    async getUser() {\r\n        var _a;\r\n        return (_a = (await this.auth0)) === null || _a === void 0 ? void 0 : _a.getUser();\r\n    }\r\n    async getTokenSilently() {\r\n        return this.renew();\r\n    }\r\n}\r\n//# sourceMappingURL=web.js.map"],"names":["registerPlugin","WebPlugin","createAuth0Client"],"mappings":"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"}